{% extends 'base.html'  %}

{% block head_contents %}
    <title>Wallet</title>
{% endblock %}

{% block contents %}
    <div class="home-body">
        <h1>Welcome to Wallet</h1>

        <h2>Net worth: ${{ net_worth }}</h2>

        <h2>Account balances</h2>
        <button id="link-button">Add an account</button>

        {% for account in accounts %}
            <div style="display: flex; flex-direction: column; margin-bottom: 40px">
                <h3>{{ account.institution.name }}</h3>
                {#            <h3>Name: {{ account.name }}</h3>#}

{#                 todo: May be more efficient with a filter query, which is likely not possible in templates.#}
                {% for sub_acc in account.sub_accounts.all %}
                    {% if not sub_acc.ignored %}
                        <div style="display: flex">
                            <h4>Name: {{ sub_acc.name }}</h4>
                            <h4>Balance: {{ sub_acc.current }}</h4>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% endfor %}
        {# todo: Load transactions and account info async with JS #}

        {#         todo: Sort by date in the view#}

        <h2>Transactions</h2>
        {# Required to show borders?#}
        <table style="border-collapse: collapse;">
        {% for tran in transactions %}
            <tr class="transaction">
                <td class="transaction-cell"><h4 class="tran-heading">{{ tran.categories}}</h4></td>
                <td class="transaction-cell"><h4 class="tran-heading" style="font-weight: normal;">{{ tran.description }}</h4></td>
                <td class="{{ tran.amount_class }} transaction-cell"><h4 class="tran-headin"g>{{ tran.amount }}</h4></td>
                <td class="transaction-cell"><h4 class="tran-heading">{{ tran.date_display }}</h4></td>
            </tr>
        {% endfor %}
        </table>

        {# todo: Load locally. #}
        <script src="https://cdn.plaid.com/link/v2/stable/link-initialize.js"></script>

        <script src="../static/main.js"></script>
    </div>

    <script>
        document.getElementById("menu-dashboard").style.color = "#F6F7EB"
    </script>
{% endblock %}